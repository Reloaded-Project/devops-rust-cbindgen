<div align="center">
  <a href="https://github.com/Reloaded-Project/reloaded-templates-rust" target="_blank">
    <img src="assets/reloaded-logo.png" alt="reloaded Logo" width="100"/>
  </a>

  <h1 align="center">Generate bindings with cbindgen</h1>

  <p>
    <a href="LICENSE">
      <img src="https://img.shields.io/badge/License-MIT-blue.svg" alt="License">
    </a>
  </p>
</div>

This GitHub Action generates C bindings with cbindgen for a Rust project.

## Inputs

| Input                     | Required | Default         | Description                                                                    |
| ------------------------- | -------- | --------------- | ------------------------------------------------------------------------------ |
| `rust-project-path`       | No       | `.`             | Path to the Rust project                                                       |
| `config-file`             | Yes      | `cbindgen.toml` | Configuration file for cbindgen                                                |
| `output-header-file`      | Yes      | `bindings_c.h`  | Path to the output header file generated by cbindgen                           |
| `upload-artifact`         | No       | `true`          | Whether to upload the generated header file as an artifact                     |
| `github-token`            | No       |                 | A GitHub token for pushing to the repo. Example: `${{ secrets.GITHUB_TOKEN }}` |
| `commit-updated-bindings` | No       | `false`         | Whether to commit the updated bindings                                         |

## Example Usage

```yaml
steps:
  - uses: actions/checkout@v4
  - uses: Reloaded-Project/cbindgen-action@v1
    with:
      rust-project-path: '.'
      config-file: 'cbindgen.toml'
      output-header-file: 'bindings_c.h'
      upload-artifact: 'true'
      github-token: ${{ secrets.GITHUB_TOKEN }}
      commit-updated-bindings: 'true'
```

## Getting Artifacts

If the `upload-artifact` input is set to `true`, the generated header file will be uploaded as 
an artifact with the following name format:

```
C-Bindings-<output-header-file>
```

For example, if the `output-header-file` input is set to `bindings_c.h`, the artifact name
will be `C-Bindings-bindings_c.h`.

If you are not uploading an artifact, the generated header can be found at `${{ inputs.rust-project-path }}/${{ inputs.output-header-file }}`.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.